#!/bin/sh

usage="Setup the environment for Travis"

# Setup
#######
set -euC
root="$(cd "$(dirname "$0")/.." && pwd)"
. "$root/bin/start"

# Run action
############

# Always use lower-case import paths.
# TODO: this doens't work if the Go project isn't in the repo's root.
old=$(echo "$root" | sed 's,/Teamwork/.*,/Teamwork,')
new=$(echo "$old" | sed 's,/Teamwork,/teamwork,')
[ "$old" != "$new" ] && mv -v "$old" "$new"
root="$new/$name"

cd "$root"

# Setup dep if it's used and vendor isn't in git.
if [ -f Gopkg.toml -a ! -d vendor ]; then
	go get -u github.com/golang/dep/cmd/dep
	dep ensure
fi
